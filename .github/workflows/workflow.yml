name: build-test-publish
on:
  workflow_dispatch:
    inputs:
      tag_or_hash:
        description: "Optionally specify a Git Tag or commit hash to deploy"
        required: false
        type: string
  push:
    branches: [ "main" ]
    tags:
      - "*"
  pull_request:
    branches: [ "main" ]

jobs:
  build-test-publish:
    uses: bmc-anvil/.github/.github/workflows/orchestrator_flow.yml@main
    secrets:
      PACKAGES_USER: ${{ secrets.PACKAGES_USER }}
      PACKAGES_TOKEN_RW: ${{ secrets.PACKAGES_TOKEN_RW }}
      GH_TOKEN: ${{ github.token }}
    permissions:
      contents: read
      packages: write
      security-events: write
    with:
      build_tool: 'maven'
      build_type: 'artifact'
      java_vendor: 'oracle'
      language: 'java'
      language_version: '25'
      services_docker_in_docker: false
      static_analysis_checkstyle_skip: false
      static_analysis_checkstyle_fail_on_violations: false
      testing_options_skip: false
      versioning_semver_bump: 'patch'
      workflow_dry_run: false
